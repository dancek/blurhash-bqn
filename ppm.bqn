ConsumeComment â† {ğ•Š stream:
  {(âŠ‘stream)â‰ @+10 ? ConsumeComment 1â†“stream ; 1â†“stream}
}
ws â† @ + 9â€¿10â€¿13â€¿32
ConsumeWhitespace â† {ğ•Š stream:
  {âŠ‘(âŠ‘stream) âˆŠ ws ? ConsumeWhitespace 1â†“stream;
   '#'=âŠ‘stream ? ConsumeComment stream;
   stream}
}
ReadNumber â† {ğ•Š stream:
  stream â†© ConsumeWhitespace stream
  n â† 0
  {ğ•Š
    c â† âŠ‘stream
    stream â†© 1â†“stream
    (câ‰¥'0')âˆ§(câ‰¤'9') ?
      n â†© (c-'0')+nÃ—10
      ğ•Š@
    ;@}@
  stream â†© ConsumeWhitespace stream
  nâ€¿stream
}

Decode â‡ {ğ•Š data:
  "Only PPM type P6 supported for now!" ! "P6"â‰¡2â†‘data
  wâ€¿d2 â† ReadNumber 2â†“data
  hâ€¿d3 â† ReadNumber d2
  mâ€¿pxs â† ReadNumber d3
  "Only 8-bit PPM channels are supported for now!" ! m<256

  2â€¿0â€¿1 â‰â¼ wâ€¿hâ€¿3â¥Špxs-@
}
